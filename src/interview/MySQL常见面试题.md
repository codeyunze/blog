---
icon: fa-solid fa-database
date: 2024-09-02
order: 15
categories:
   - 数据库
tags:
   - MySQL
---

MySQL数据库在面试过程中，常常会被问到问题有索引结构、性能调优、分库分表、锁。

<!-- more -->

# MySQL常见的面试题

## 1. MySQL的索引是什么？

索引是针对数据表里某个字段或某些字段，做好排序的数据结构。

## 2. 聚集（聚簇）索引和非聚集（非聚簇）索引是什么？

聚集索引是索引结构里的叶子节点带了数据信息，就是表数据的一整行数据，索引和数据在同一个 `.idb` 文件里。

非聚集索引是索引和数据分离的，索引在 `.myi` 文件里，数据文件在 `.myd` 文件里。

## 3. MySQL的锁有哪些？

按照锁的粒度划分



行锁：是最低粒度的的锁，锁住指定行的数据，加锁的开销较大，加锁较慢，可能会出现死锁的情况，锁的竞争度会较低，并发度相对较高。但是如果where条件里的字段没有加索引，则加的行锁会自动升级为表锁，因为行锁是基于索引去进行操作的，所以想要加行锁，就一定要在条件字段为索引的基础上进行操作。

表锁：锁住指定的表，粒度较大，但是加锁的开销小，加锁快，不会出现死锁，且锁的竞争度会较为激烈，并发度比行锁要低很多。



全局锁：粒度最大的锁，会锁住整个库，所有的表都不能进行更新插入操作，只能读。

全局锁命令如下：

```sql
flush tables with read lock;
```



页锁



按照互斥性划分

共享锁（读锁）：一个事务给某行数据加上共享锁之后，其他事务就不能再加拍排它锁，但是可以加共享锁。

排它锁（写锁）：一个事务给某行数据加上排它锁之后，其他事务就不能再给这行数据加任何锁，即不允许写，也不允许读。



按照性能划分

乐观锁

悲观锁

意向锁



间隙锁：是在索引记录之间的间隙上加的一个锁，是锁定了一个数据区间，比如一数据表的字段a数据为[1, 2, 3, 4]，如果sql如下

```sql
select * from tablename where a = 3 for update;
```

，则加的间隙锁就是[2, 4]，间隙的范围是根据检索条件向下寻找最靠近检索条件的记录值A，用于作为左区间，向上寻找最靠近检索条件的记录值B，用于作为右区间，即锁定的间隙为（A，B）。加上了间隙锁，则[2, 4]区间的数据都不能再进行操作，知道锁释放。
