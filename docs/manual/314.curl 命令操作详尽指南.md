# curl å‘½ä»¤æ“ä½œè¯¦å°½æŒ‡å—

> **é€‚ç”¨å¯¹è±¡**ï¼šå¼€å‘è€…ã€è¿ç»´å·¥ç¨‹å¸ˆã€æµ‹è¯•äººå‘˜ã€è‡ªåŠ¨åŒ–è„šæœ¬ç¼–å†™è€…
> **ç›®æ ‡**ï¼šæŒæ¡ `curl` çš„æ ¸å¿ƒç”¨æ³•ï¼Œé«˜æ•ˆè°ƒè¯• APIã€ä¸‹è½½æ–‡ä»¶ã€æ¨¡æ‹Ÿè¯·æ±‚

------

## ä¸€ã€ä»€ä¹ˆæ˜¯ curlï¼Ÿ

`curl` æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚å®ƒæ”¯æŒå¤šç§åè®®ï¼ˆHTTPã€HTTPSã€FTPã€SFTPã€LDAP ç­‰ï¼‰ï¼Œå°¤å…¶æ“…é•¿å‘é€å’Œæ¥æ”¶ **HTTP/HTTPS è¯·æ±‚**ã€‚

- è°ƒè¯• RESTful API  
- è‡ªåŠ¨åŒ–æ–‡ä»¶ä¸‹è½½/ä¸Šä¼   
- æ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸º  
- æµ‹è¯•æ¥å£è®¤è¯ã€é‡å®šå‘ã€è¶…æ—¶ç­‰åœºæ™¯

> ğŸ’¡ **æç¤º**ï¼šç†Ÿç»ƒä½¿ç”¨ `curl` å¯æ›¿ä»£ Postman ç­‰å›¾å½¢åŒ–å·¥å…·è¿›è¡Œå¿«é€Ÿæµ‹è¯•ï¼

------

## äºŒã€å®‰è£… curl

å¤§å¤šæ•°ç°ä»£æ“ä½œç³»ç»Ÿå·²é¢„è£… `curl`ã€‚è‹¥æœªå®‰è£…ï¼Œè¯·æŒ‰ä»¥ä¸‹æ–¹å¼æ“ä½œï¼š

| ç³»ç»Ÿ          | å®‰è£…å‘½ä»¤                                                     |
| ------------- | ------------------------------------------------------------ |
| Ubuntu/Debian | `sudo apt install curl`                                      |
| CentOS/RHEL   | `sudo yum install curl` æˆ– `sudo dnf install curl`           |
| macOS         | å·²å†…ç½®ï¼›è‹¥ç¼ºå¤±ï¼Œè¿è¡Œ `brew install curl`                     |
| Windows 10+   | å·²å†…ç½®ï¼›æ—§ç‰ˆè¯·ä» [curl.se/download](https://curl.se/download.html) ä¸‹è½½ |

éªŒè¯å®‰è£…ï¼š

```bash
curl --version
```

------

## ä¸‰ã€åŸºç¡€ç”¨æ³•ï¼šGET è¯·æ±‚

### é»˜è®¤è¡Œä¸ºå°±æ˜¯ GET

```bash
curl https://httpbin.org/get
```

> **è¯´æ˜**ï¼šä¸åŠ ä»»ä½•å‚æ•°æ—¶ï¼Œ`curl` é»˜è®¤å‘é€ GET è¯·æ±‚ï¼Œå¹¶å°†å“åº”ä½“è¾“å‡ºåˆ°ç»ˆç«¯ã€‚

### ä¿å­˜å“åº”åˆ°æ–‡ä»¶

```bash
curl -o response.json https://api.example.com/data
```

> **é€‰é¡¹**ï¼š`-o filename` å°†è¾“å‡ºå†™å…¥æŒ‡å®šæ–‡ä»¶ï¼ˆè¦†ç›–æ¨¡å¼ï¼‰
> **ç­‰ä»·å†™æ³•**ï¼š`curl https://... > response.json`

------

## å››ã€å¸¸è§ HTTP æ–¹æ³•æ“ä½œ

### 1ï¸âƒ£ POST è¯·æ±‚ï¼ˆæäº¤è¡¨å•æ•°æ®ï¼‰

```bash
curl -X POST -d "username=admin&password=123456" https://api.example.com/login
```

> **è¯´æ˜**ï¼š
>
> - `-X POST`ï¼šæ˜¾å¼æŒ‡å®šè¯·æ±‚æ–¹æ³•ä¸º POST  
> - `-d`ï¼šå‘é€ URL ç¼–ç çš„è¡¨å•æ•°æ®ï¼ˆContent-Type é»˜è®¤ä¸º `application/x-www-form-urlencoded`ï¼‰

------

### 2ï¸âƒ£ POST JSON æ•°æ®ï¼ˆæœ€å¸¸ç”¨ï¼ï¼‰

```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"name":"å¼ ä¸‰","age":28}' \
  https://api.example.com/users
```

> **å…³é”®ç‚¹**ï¼š
>
> - å¿…é¡»æ‰‹åŠ¨è®¾ç½® `-H "Content-Type: application/json"`  
> - `-d` åè·Ÿåˆæ³• JSON å­—ç¬¦ä¸²ï¼ˆå»ºè®®ç”¨å•å¼•å·åŒ…è£¹ï¼‰

------

### 3ï¸âƒ£ PUT / PATCHï¼ˆæ›´æ–°èµ„æºï¼‰

```bash
# å®Œæ•´æ›¿æ¢
curl -X PUT -H "Content-Type: application/json" -d '{"status":"active"}' https://api.example.com/users/123

# éƒ¨åˆ†æ›´æ–°ï¼ˆPATCHï¼‰
curl -X PATCH -H "Content-Type: application/json" -d '{"email":"new@example.com"}' https://api.example.com/users/123
```

------

### 4ï¸âƒ£ DELETEï¼ˆåˆ é™¤èµ„æºï¼‰

```bash
curl -X DELETE https://api.example.com/users/123
```

------

## äº”ã€å¸¸ç”¨é€‰é¡¹ä¸æŠ€å·§

### è®¾ç½®è¯·æ±‚å¤´ï¼ˆHeadersï¼‰

```bash
curl -H "Authorization: Bearer abc123xyz" \
     -H "User-Agent: MyApp/1.0" \
     https://api.example.com/profile
```

> **ç”¨é€”**ï¼šä¼ é€’ Tokenã€è‡ªå®šä¹‰ UAã€æŒ‡å®š Accept ç±»å‹ç­‰ã€‚

------

### è·Ÿéšé‡å®šå‘ï¼ˆ3xxï¼‰

```bash
curl -L https://example.com/old-page
```

> **è¯´æ˜**ï¼šé»˜è®¤ `curl` ä¸è·Ÿéšé‡å®šå‘ï¼ŒåŠ  `-L` åè‡ªåŠ¨è·³è½¬ã€‚

------

### æ˜¾ç¤ºè¯¦ç»†è¯·æ±‚/å“åº”è¿‡ç¨‹ï¼ˆè°ƒè¯•å¿…å¤‡ï¼ï¼‰

```bash
curl -v https://api.example.com/test
```

> **è¾“å‡ºå†…å®¹**ï¼š
>
> - è¯·æ±‚è¡Œã€è¯·æ±‚å¤´  
> - å“åº”çŠ¶æ€ç ã€å“åº”å¤´  
> - è¿æ¥ç»†èŠ‚ï¼ˆDNSã€TCPã€SSL æ¡æ‰‹ç­‰ï¼‰

------

### ä»…è·å–å“åº”å¤´ï¼ˆHEAD è¯·æ±‚ï¼‰

```bash
curl -I https://www.baidu.com
```

> **ç­‰ä»·äº**ï¼š`curl -X HEAD -i https://...`
> **ç”¨é€”**ï¼šæ£€æŸ¥èµ„æºæ˜¯å¦å­˜åœ¨ã€è·å– Content-Lengthã€Last-Modified ç­‰å…ƒä¿¡æ¯ã€‚

------

### è®¾ç½®è¶…æ—¶æ—¶é—´

```bash
# è¿æ¥è¶…æ—¶ 5 ç§’ï¼Œæ€»è¯·æ±‚è¶…æ—¶ 10 ç§’
curl --connect-timeout 5 --max-time 10 https://slow-api.com
```

------

### ä¸Šä¼ æ–‡ä»¶ï¼ˆmultipart/form-dataï¼‰

```bash
curl -X POST -F "file=@/path/to/photo.jpg" https://api.example.com/upload
```

> **è¯´æ˜**ï¼š
>
> - `-F` è¡¨ç¤ºä½¿ç”¨ `multipart/form-data` æ ¼å¼  
> - `@` åè·Ÿæœ¬åœ°æ–‡ä»¶è·¯å¾„

------

## å…­ã€è®¤è¯ä¸å®‰å…¨

### Basic è®¤è¯

```bash
curl -u username:password https://protected.example.com
```

> **ç­‰ä»·å†™æ³•**ï¼š`curl -H "Authorization: Basic $(echo -n 'user:pass' | base64)" ...`

------

### Bearer Tokenï¼ˆJWT/OAuth2ï¼‰

```bash
curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." https://api.example.com/me
```

------

### ğŸ”’ å¿½ç•¥ SSL è¯ä¹¦é”™è¯¯ï¼ˆä»…æµ‹è¯•ç¯å¢ƒï¼ï¼‰

```bash
curl -k https://self-signed.badssl.com
```

> âš ï¸ **è­¦å‘Š**ï¼šç”Ÿäº§ç¯å¢ƒåˆ‡å‹¿ä½¿ç”¨ `-k`ï¼

------

## ä¸ƒã€Cookie ä¸ä¼šè¯ç®¡ç†

### ä¿å­˜ Cookie åˆ°æ–‡ä»¶

```bash
curl -c cookies.txt https://login.example.com
```

### ä½¿ç”¨ Cookie å‘èµ·åç»­è¯·æ±‚

```bash
curl -b cookies.txt https://dashboard.example.com
```

> **è¯´æ˜**ï¼š
>
> - `-c`ï¼šä¿å­˜å“åº”ä¸­çš„ Set-Cookie åˆ°æ–‡ä»¶  
> - `-b`ï¼šå‘é€è¯·æ±‚æ—¶æºå¸¦ Cookie æ–‡ä»¶ä¸­çš„å€¼

------

## å…«ã€æ€§èƒ½ä¸è°ƒè¯•

### æ˜¾ç¤ºè¯·æ±‚è€—æ—¶

```bash
curl -w "æ€»è€—æ—¶: %{time_total}s\nå“åº”ç : %{http_code}\n" \
     -o /dev/null -s \
     https://api.example.com
```

> **å¸¸ç”¨å˜é‡**ï¼š
>
> - `%{time_total}`ï¼šæ€»æ—¶é—´ï¼ˆç§’ï¼‰  
> - `%{http_code}`ï¼šHTTP çŠ¶æ€ç   
> - `%{size_download}`ï¼šä¸‹è½½å­—èŠ‚æ•°

------

### é‡åˆ° HTTP é”™è¯¯æ—¶è¿”å›éé›¶é€€å‡ºç 

```bash
curl -f https://api.example.com/error || echo "è¯·æ±‚å¤±è´¥ï¼"
```

> **è¯´æ˜**ï¼š`-f` é€‰é¡¹ä½¿ `curl` åœ¨æ”¶åˆ° 4xx/5xx å“åº”æ—¶è¿”å›é 0 é€€å‡ºç ï¼Œä¾¿äºè„šæœ¬åˆ¤æ–­ã€‚

------

## ä¹ã€ç»¼åˆå®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹ï¼šå®Œæ•´ç™»å½• + è·å–ç”¨æˆ·ä¿¡æ¯

```bash
# 1. ç™»å½•å¹¶ä¿å­˜ Cookie
curl -c auth.cookie \
     -d "username=admin&password=secret" \
     https://api.example.com/login

# 2. ä½¿ç”¨ Cookie è·å–ç”¨æˆ·èµ„æ–™
curl -b auth.cookie \
     https://api.example.com/profile
```

------

### æ¡ˆä¾‹ï¼šå¸¦ Token çš„ JSON POST å¹¶è®°å½•è€—æ—¶

```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $(cat token.txt)" \
  -d '{"title":"æ–°ä»»åŠ¡","priority":"high"}' \
  -w "è€—æ—¶: %{time_total}s | çŠ¶æ€: %{http_code}\n" \
  -o task_response.json \
  https://api.example.com/tasks
```

------

## åã€å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜                  | è§£å†³æ–¹æ¡ˆ                                                  |
| --------------------- | --------------------------------------------------------- |
| è¿”å› 400 Bad Request  | æ£€æŸ¥ JSON æ ¼å¼æ˜¯å¦åˆæ³•ã€Content-Type æ˜¯å¦æ­£ç¡®             |
| è¿”å› 401 Unauthorized | æ£€æŸ¥ Token æ˜¯å¦è¿‡æœŸã€Header æ˜¯å¦æ‹¼å†™é”™è¯¯                  |
| è¿æ¥è¶…æ—¶              | åŠ  `--connect-timeout` å’Œ `--max-time`ï¼Œæˆ–æ£€æŸ¥ç½‘ç»œ/é˜²ç«å¢™ |
| ä¸­æ–‡ä¹±ç               | æ·»åŠ  `-H "Accept-Charset: utf-8"` æˆ–ç»ˆç«¯è®¾ç½® UTF-8 ç¼–ç    |
| æ— æ³•ä¸Šä¼ æ–‡ä»¶          | ç¡®è®¤è·¯å¾„æ­£ç¡®ï¼Œä½¿ç”¨ `-F "file=@./filename"`ï¼ˆæ³¨æ„ `@`ï¼‰    |

------

## åä¸€ã€é™„å½•ï¼šé€ŸæŸ¥è¡¨

| åŠŸèƒ½       | å‘½ä»¤                                                         |
| ---------- | ------------------------------------------------------------ |
| GET è¯·æ±‚   | `curl https://url`                                           |
| POST JSON  | `curl -X POST -H "Content-Type: application/json" -d '{}' url` |
| å¸¦ Token   | `curl -H "Authorization: Bearer xxx" url`                    |
| ä¿å­˜å“åº”   | `curl -o file.txt url`                                       |
| è°ƒè¯•è¯¦æƒ…   | `curl -v url`                                                |
| è·Ÿéšé‡å®šå‘ | `curl -L url`                                                |
| æ˜¾ç¤ºè€—æ—¶   | `curl -w "%{time_total}s" -o /dev/null -s url`               |

------

## ç»“è¯­

`curl` æ˜¯æ¯ä¸ªå¼€å‘è€…éƒ½åº”æŒæ¡çš„â€œç‘å£«å†›åˆ€â€ã€‚é€šè¿‡çµæ´»ç»„åˆé€‰é¡¹ï¼Œä½ å¯ä»¥ï¼š

- å¿«é€ŸéªŒè¯ API æ¥å£
- ç¼–å†™è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
- æ¨¡æ‹Ÿå¤æ‚ç”¨æˆ·è¡Œä¸º
- ç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€