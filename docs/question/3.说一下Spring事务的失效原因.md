---
title: 说一下Spring事务的失效原因
createTime: 2025/10/26 19:45:27
permalink: /article/9d7qy0z0/
tags:
  - 每日一问
  - java基础
  - Spring基础
  - 事务
---

1. 调用内部类
2. 事务的传播行为设置不当
3. 设置了rollbackFor指定特定的生效异常类型
4. 用try cache自行捕获了异常

<!-- more -->

------

情况一：

主要情况有在定义了@Transaction注解的方法里，调用本类的其他方法。

不生效的原因是Spring的事务是使用AOP实现的，切入点是bean对象，是目标类的代理对象，而使用this.xxx()调用本类方法时，用的不是代理对象，而是目标类对象的本身，所以是绕过了代理对象，也就导致事务的AOP切面介入不了这个方法的执行。

情况二：

还有事务的传播行为设置不当也会导致事务失效，例如设置为 `@Transactional(propagation = Propagation.NOT_SUPPORTED)` ，不支持事务，无事务执行。

情况三：

在@Transactional注解上设置了rollbackFor指定特定的生效异常类型，当抛出异常不匹配时，自然不会触发事务。

情况四：

在代码里使用try cache自行捕获了异常，这就表示这个方法不会再捕获到异常了，也自然就不会触发事务。

