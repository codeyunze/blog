---
title: CopyOnWrityArrayList的底层原理是怎么样的
createTime: 2025/10/26 19:41:46
permalink: /article/mgmm9wq3/
tags:
  - 每日一问
  - java基础
---

写时复制；

写操作有synchronized，是复制旧数组到新数组，然后新增元素最加到新数组，最后替换内存地址；

读操作是读的旧数组；

<!-- more -->

CopyOnWrityArrayList是线程安全的List，最核心的特点是写时复制。

在新加入一个元素时，CopyOnWrityArrayList会给add这个操作方法先套上synchronized，所以他是线程安全的，其他线程调用add方法都需要阻塞等待。执行add方法时，CopyOnWrityArrayList会将当前数组的元素全部复制到一个新的数组里，新数组长度加一，然后将新增的元素插入到新数组里，最后再将新数组的内存地址替换过去。在次期间，所有的读操作，都还读的是旧的数组，不会受到新增操作加锁的影响。

这种机制在写操作频繁时会有较大的内存开销和性能问题，因为每次写都要复制整个数组，所以他比较适合读多写少的场景。