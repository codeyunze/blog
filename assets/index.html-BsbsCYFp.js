import{_ as a,e as n,f as p,o as e}from"./app-Cx_oisp2.js";const c="/assets/fdf0a79b57c02102fc3f14f015d126d6-Chy2seBt.png",t="/assets/964347f4492a9d1be337390ce75b6025-CjaBvSgy.png",l="/assets/ae43467d1c188bb95cc350b28fa11f53-CB6qmNBn.png",i={};function o(r,s){return e(),n("div",null,s[0]||(s[0]=[p(`<p>针对es上已经存在的索引，在某些情况下可能需要变更其字段属性的数据类型，但是es是没有办法像关系数据库一样直接使用一行alter命令解决的。</p><p>本文就针对这一需求，使用一种数据迁移的办法实现了索引的字段属性数据类型变更。</p><p>现有这么一个索引es_test，需要要将age属性和sex的属性的数据类型从long改为integer</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>PUT</span><span class="space"> </span><span>/es_test/_doc/1</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;name&quot;:</span><span class="space"> </span><span>&quot;张三&quot;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;sex&quot;:</span><span class="space"> </span><span>1,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;age&quot;:</span><span class="space"> </span><span>23,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;address&quot;:</span><span class="space"> </span><span>&quot;广州天河公园&quot;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>原es_test的映射如下图右侧所示； <img src="`+c+`" alt="在这里插入图片描述"></p><h2 id="第一步-创建一个新的索引-定义好所需映射" tabindex="-1"><a class="header-anchor" href="#第一步-创建一个新的索引-定义好所需映射"><span>第一步，创建一个新的索引，定义好所需映射</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>PUT</span><span class="space"> </span><span>/es_test_bak</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;mappings&quot;:</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;properties&quot;:</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;name&quot;:</span><span class="space"> </span><span>{&quot;type&quot;:</span><span class="space"> </span><span>&quot;keyword&quot;,</span><span class="space"> </span><span>&quot;index&quot;:</span><span class="space"> </span><span>true,</span><span class="space"> </span><span>&quot;store&quot;:</span><span class="space"> </span><span>true},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;sex&quot;:</span><span class="space"> </span><span>{&quot;type&quot;:</span><span class="space"> </span><span>&quot;integer&quot;,</span><span class="space"> </span><span>&quot;index&quot;:</span><span class="space"> </span><span>true,</span><span class="space"> </span><span>&quot;store&quot;:</span><span class="space"> </span><span>true},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;age&quot;:</span><span class="space"> </span><span>{&quot;type&quot;:</span><span class="space"> </span><span>&quot;integer&quot;,</span><span class="space"> </span><span>&quot;index&quot;:</span><span class="space"> </span><span>true,</span><span class="space"> </span><span>&quot;store&quot;:</span><span class="space"> </span><span>true},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;address&quot;:</span><span class="space"> </span><span>{&quot;type&quot;:</span><span class="space"> </span><span>&quot;text&quot;,</span><span class="space"> </span><span>&quot;index&quot;:true,</span><span class="space"> </span><span>&quot;store&quot;:</span><span class="space"> </span><span>true}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>}</span><span class="space"> </span><span class="space"> </span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>}</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="第二步-将es-test索引的数据复制到es-test-bak索引里" tabindex="-1"><a class="header-anchor" href="#第二步-将es-test索引的数据复制到es-test-bak索引里"><span>第二步，将es_test索引的数据复制到es_test_bak索引里</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>POST</span><span class="space"> </span><span>_reindex</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;source&quot;:</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;index&quot;:</span><span class="space"> </span><span>&quot;es_test&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>},</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>&quot;dest&quot;:</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&quot;index&quot;:</span><span class="space"> </span><span>&quot;es_test_bak&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>}</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+t+'" alt="在这里插入图片描述"></p><h2 id="第三步-删除掉原es-test索引" tabindex="-1"><a class="header-anchor" href="#第三步-删除掉原es-test索引"><span>第三步，删除掉原es_test索引</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>DELETE</span><span class="space"> </span><span>/es_test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="第四步-给es-test-bak索引设置一个es-test的别名" tabindex="-1"><a class="header-anchor" href="#第四步-给es-test-bak索引设置一个es-test的别名"><span>第四步，给es_test_bak索引设置一个es_test的别名</span></a></h2><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>PUT</span><span class="space"> </span><span>/es_test_bak/_alias/es_test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="第五步-确认验证" tabindex="-1"><a class="header-anchor" href="#第五步-确认验证"><span>第五步，确认验证</span></a></h2><p><img src="'+l+'" alt="在这里插入图片描述"></p>',16)]))}const u=a(i,[["render",o],["__file","index.html.vue"]]),m=JSON.parse('{"path":"/article/k80niorf/","title":"轻松搞定Elasticsearch的索引字段类型变更","lang":"zh-CN","frontmatter":{"title":"轻松搞定Elasticsearch的索引字段类型变更","createTime":"2025/03/07 13:49:42","permalink":"/article/k80niorf/","tags":["Elasticsearch","问题解决方案"],"description":"针对es上已经存在的索引，在某些情况下可能需要变更其字段属性的数据类型，但是es是没有办法像关系数据库一样直接使用一行alter命令解决的。 本文就针对这一需求，使用一种数据迁移的办法实现了索引的字段属性数据类型变更。 现有这么一个索引es_test，需要要将age属性和sex的属性的数据类型从long改为integer 原es_test的映射如下图右...","head":[["meta",{"property":"og:url","content":"https://blog.gaohan.asia/article/k80niorf/"}],["meta",{"property":"og:site_name","content":"云泽汇码"}],["meta",{"property":"og:title","content":"轻松搞定Elasticsearch的索引字段类型变更"}],["meta",{"property":"og:description","content":"针对es上已经存在的索引，在某些情况下可能需要变更其字段属性的数据类型，但是es是没有办法像关系数据库一样直接使用一行alter命令解决的。 本文就针对这一需求，使用一种数据迁移的办法实现了索引的字段属性数据类型变更。 现有这么一个索引es_test，需要要将age属性和sex的属性的数据类型从long改为integer 原es_test的映射如下图右..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-02T02:30:37.000Z"}],["meta",{"property":"article:tag","content":"Elasticsearch"}],["meta",{"property":"article:tag","content":"问题解决方案"}],["meta",{"property":"article:modified_time","content":"2025-04-02T02:30:37.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"轻松搞定Elasticsearch的索引字段类型变更\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-02T02:30:37.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":1.09,"words":328},"git":{"updatedTime":1743561037000,"contributors":[{"name":"yunze","username":"yunze","email":"56632502+YUNZE-GH@users.noreply.github.com","commits":3,"avatar":"https://avatars.githubusercontent.com/yunze?v=4","url":"https://github.com/yunze"}]},"autoDesc":true,"filePathRelative":"java/240.轻松搞定Elasticsearch的索引字段类型变更.md","categoryList":[{"id":"93f725","sort":10004,"name":"java"}]}');export{u as comp,m as data};
