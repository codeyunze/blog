import{_ as a,e,f as n,o as i}from"./app-Cx_oisp2.js";const p="/assets/cap-BYAaQOVM.png",o={};function s(r,t){return i(),e("div",null,t[0]||(t[0]=[n('<p>CAP理论指出，在分布式系统中，一致性（Consistency）、可用性（Availability）和分区容忍性（Partition Tolerance）这三个特性无法同时完全满足，最多只能同时实现其中的两个。本文详细解释了每个特性的含义及其在实际系统中的表现形式，再通过具体的例子说明了在不同场景下如何权衡这些特性。</p><p>当学习分布式的redis、mq等中间件时，都会看到有提到CAP。</p><p>CAP理论是学习分布式必备的一个概念知识点。</p><p>CAP理论由三个特性组成，分别是一致性（Consistency）、可用性（Availability）、分区容错性（Partition Tolerance）。</p><blockquote><p>注意：一般的分布式的系统服务或中间件，是不能同时拥有这三个特性的，只能同时拥有其中的两个特性，要么是保证系统的一致性和分区容错性（CP），要么保证系统的可用性和分区容错性（AP）。</p></blockquote><p><img src="'+p+'" alt="cap"></p><h2 id="一致性-consistency" tabindex="-1"><a class="header-anchor" href="#一致性-consistency"><span>一致性（Consistency）</span></a></h2><p>当一条数据更新完成之后，这个分布式系统里所有的服务节点，在同一个时间点读取同一条数据得到的信是需要完全一致的。</p><p><strong>例如：</strong></p><p>我在分布式系统里的服务A处操作更新数据，将一条数据更新为 “张三” ，当服务A响应更新成功之后，此时不管从服务A还是从服务B读取这条数据，得到的都要是 ”张三“ ，而不能是其他。</p><p><strong>存在的问题：</strong></p><p>当服务A响应数据更新成功之后，服务A是需要将更新的数据同步到服务B、服务C等其他分布式系统节点的，这个同步的过程就会导致数据的实时性存在一定的延迟。</p><p>会出现在服务A更新完成之后，数据还没有同步到其他服务节点时，有个请求需要从服务B节点读取这条数据，此时就会导致数据的不一致问题。</p><p>而为了保证数据的一致性，解决不一致的问题，就会对这个数据资源进行一个加锁操作，加锁之后，所有的请求就不得对该数据资源进行操作，请求会进入阻塞状态。</p><p>只有的等各个服务的数据同步完之后，才会释放这个资源的锁。</p><p>所以要保证分布式系统各服务之间数据的一致性，就势必会影响到整个系统的性能，对其吞吐量会有一定的影响。</p><h2 id="可用性-availability" tabindex="-1"><a class="header-anchor" href="#可用性-availability"><span>可用性（Availability）</span></a></h2><p>对于所有的读操作和写操作，系统一直处于可用的状态，且响应时间正常，不会出现超时，响应错误等不友好的情况（但是不保证获取到或操作的数据是最新数据）。</p><p>可用性呢，可以简单的理解为牺牲了一定的数据一致性，不能等到分布式系统的各个服务进行数据同步完成之后，才来响应客户的请求，为了性能需要立刻马上去响应用户的请求。</p><p>所以如果要保证系统的可用性，分布式系统的各个服务进行数据同步时，不能进行加锁阻塞用户的请求操作，只能异步的去进行数据同步写操作。</p><h2 id="分区容错性-partition-tolerance" tabindex="-1"><a class="header-anchor" href="#分区容错性-partition-tolerance"><span>分区容错性（Partition Tolerance）</span></a></h2><p>一个分布式系统的各个服务是分散部署在各个服务器、各个地区机房的。</p><p>当分布式系统的某一节点服务在遇到各种各样的网络、服务器故障之后，无法正常提供服务时，不会影响到整个系统，其他节点的服务依旧可以正常提供服务，这个是分布式的初衷，也是分布式系统需求具备的基本能力。</p><p>如果达不到这个能力，那这个系统都不能称为一个分布式系统。</p><p><strong>例如：</strong> redis主从架构集群，被分散部署在不同的服务器、机房里面，当其中一个redis主节点挂掉宕机之后，会由被部署在其他服务器上的redis从节点顶上来，整个系统不会因为其中一个redis节点出现问题，而停止提供服务。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>分布式系统一定是要保证分区容错性的，然后就是在一致性和可用性之间进行一个取舍。</p><p>为了保证数据的一致性，就势必会因为加锁、网络波动等原因，去阻塞用户的请求，这就必然达不到可用性的要求。</p><p>而为了保证可用性，而使分布式系统的各个服务节点之间用异步操作去同步数据，就定然会在导致数据还没同步完成时，用户请求到旧数据的问题，就无法达到一致性的要求。</p><p>所以一个分布式系统只能达到CAP理论其中的两个特性，要么是保证系统的一致性和分区容错性（CP），要么保证系统的可用性和分区容错性（AP）。</p><h2 id="base理论" tabindex="-1"><a class="header-anchor" href="#base理论"><span>BASE理论</span></a></h2><blockquote><p>BASE是基本可用（Basically Available）、软状态（Soft state）、最终一致性（Eventually consistent）。</p></blockquote><p>BASE理论就是针对CAP中一致性和可用性存在冲突，而进行的一个权衡妥协的结果，是基于CAP理论和互联网系统不断实践而逐步演化而来。</p><p>BASE理论的核心是，即便无法做到数据的强一致性，系统的每个服务，都可以使用合适的方法，来达到系统数据的最终一致性。</p><h3 id="基本可用-basically-available" tabindex="-1"><a class="header-anchor" href="#基本可用-basically-available"><span>基本可用（Basically Available）</span></a></h3><p>分两种情况</p><ol><li><strong>延长响应时间：</strong> 正常情况下，处理用户的请求只需要几百毫秒，但是在进行数据同步时，或系统出现异常情况时，用户的请求响应时间会延长到几秒。</li><li><strong>关闭非必要功能：</strong> 正常情况下，系统的所有功能都可以被正常使用，但是在某些场景下（如双11、新iPhone发布等），部分非必要的功能就会暂时无法使用（例如退货功能在当天就无法使用），以减轻系统压力。</li></ol><h3 id="软状态-soft-state" tabindex="-1"><a class="header-anchor" href="#软状态-soft-state"><span>软状态（Soft state）</span></a></h3><p>分布式系统各服务之间的数据同步允许一定时间的延迟。</p><h3 id="最终一致性-eventually-consistent" tabindex="-1"><a class="header-anchor" href="#最终一致性-eventually-consistent"><span>最终一致性（Eventually consistent）</span></a></h3><p>分布式系统中各个服务所掌管的数据，在经过一段时间的数据同步后，最终会达到一致，系统不要求其实时性。</p>',41)]))}const c=a(o,[["render",s],["__file","index.html.vue"]]),h=JSON.parse('{"path":"/article/231bku5m/","title":"分布式的理论基础CAP理论","lang":"zh-CN","frontmatter":{"title":"分布式的理论基础CAP理论","createTime":"2025/03/06 14:10:30","permalink":"/article/231bku5m/","tags":["分布式","CAP"],"description":"CAP理论指出，在分布式系统中，一致性（Consistency）、可用性（Availability）和分区容忍性（Partition Tolerance）这三个特性无法同时完全满足，最多只能同时实现其中的两个。本文详细解释了每个特性的含义及其在实际系统中的表现形式，再通过具体的例子说明了在不同场景下如何权衡这些特性。 当学习分布式的redis、mq等中...","head":[["meta",{"property":"og:url","content":"https://blog.gaohan.asia/article/231bku5m/"}],["meta",{"property":"og:site_name","content":"云泽汇码"}],["meta",{"property":"og:title","content":"分布式的理论基础CAP理论"}],["meta",{"property":"og:description","content":"CAP理论指出，在分布式系统中，一致性（Consistency）、可用性（Availability）和分区容忍性（Partition Tolerance）这三个特性无法同时完全满足，最多只能同时实现其中的两个。本文详细解释了每个特性的含义及其在实际系统中的表现形式，再通过具体的例子说明了在不同场景下如何权衡这些特性。 当学习分布式的redis、mq等中..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-02T02:30:37.000Z"}],["meta",{"property":"article:tag","content":"分布式"}],["meta",{"property":"article:tag","content":"CAP"}],["meta",{"property":"article:modified_time","content":"2025-04-02T02:30:37.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"分布式的理论基础CAP理论\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-04-02T02:30:37.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":5.7,"words":1709},"git":{"updatedTime":1743561037000,"contributors":[{"name":"yunze","username":"yunze","email":"56632502+YUNZE-GH@users.noreply.github.com","commits":6,"avatar":"https://avatars.githubusercontent.com/yunze?v=4","url":"https://github.com/yunze"}]},"autoDesc":true,"filePathRelative":"java/231.分布式的理论基础CAP理论.md","categoryList":[{"id":"93f725","sort":10004,"name":"java"}]}');export{c as comp,h as data};
